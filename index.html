<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
		<title>OneManager jump page</title>
		<script src="https://code.jquery.com/jquery-2.2.4.js" integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI=" crossorigin="anonymous"></script>
	</head>
	<body>
		<div id='test1'>
			<a id="direct">No link here!</a><br>
			Pls see the code here<br>
		</div>
		<div id='test2'>	
			Pls see refresh token here<br>
		</div>

		<script>
      			var q = new Array();
			var query = window.location.search.substring(1);
			//document.getElementById('test1').innerHTML=query;
			var vars = query.split("&");
			for (var i=0;i<vars.length;i++) {
				var pair = vars[i].split("=");
				q[pair[0]]=pair[1];
			}
			var url = q['session_state'];
			var code = q['code'];
			var accessToken = q['access_token'];
			var refresh_token = q['refresh_token'];
			
			if (!!url && !!code) {
				document.getElementById('test1').innerHTML+='<b>Code:</b><div><textarea rows="9" cols="160">'+code+'</textarea></div>';
				document.getElementById('test1').innerHTML+='<p>';
				document.getElementById('test1').innerHTML+='<b>State:</b><div><textarea rows="3" cols="160">'+url+'</textarea></div>';

			} 
			else if (!!accessToken && !!refresh_token) {
				document.getElementById('test1').innerHTML+='<b>Access Token:</b><div><textarea rows="16" cols="160">'+accessToken+'</textarea></div>';
				document.getElementById('test1').innerHTML+='<p>';
				document.getElementById('test1').innerHTML+='<b>Refresh Token:</b><div><textarea rows="10" cols="160">'+refresh_token+'</textarea></div>';
			}
			else {
				var str='Error! 有误！';
				if (!url) str+='No url! url参数为空！';
				else document.getElementById('test1').innerHTML='<a href="'+decodeURIComponent(decodeURIComponent(url))+'">'+decodeURIComponent(decodeURIComponent(url))+'</a><br>';
				if (!code) str+='No code from MS! 微软code为空！';
				document.getElementById('test1').innerHTML+=str+'<br>'+decodeURIComponent(query.replace(/\+/g,'%20'));
				//alert(str);
			}
			
		</script>
	</body>
</html>
